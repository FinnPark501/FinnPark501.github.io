---
layout: post
title:  "우리 회사의 오랜 문제"
date:   2024-03-07 23:22:00 +0900
categories: Work
---
우리 회사의 오랜 문제
===

블로그를 영/한 병기할지, 한국어로만 쓸지 아직 마음을 못 정했다. 사실 이 블로그를 볼 사람이 많을 것 같지는 않으니, 당분간은 마음 가는대로 작성해도 무관할듯 싶다.  

---
우리 회사에서 일하면서 지금껏 불합리하다고 느껴온 3가지가 있다. 읽으면서 놀라지 마시라.   
우리 회사는 파라미터 관리를 위해 #ifdef 문법을 사용한다. 그게 무슨 말인고 하면,
```C
//#define MODEL_A
#define MODEL_B
//#define MODEL_C
...
{
    uint8_t parameter_a;

#ifdef MODEL_A
    parmemter_a=5;
#endif

#ifdef MODEL_B
    parameter_a=8;
#endif

#ifdef MODEL_C
    parameter_a=138;
#endif
...
}
```
이런 식이다.   
코드를 딱 봤을 때에는 이게 무슨 문제인가 할 것이다. 하지만 아래의 사실과 합쳐진다면 엄청난 결론이 나온다.

---
#### 사실 1: 우리는 Project Build 전 이 MODEL 상수를 일일이 직접 손으로 수정하고 Build 한다. 
#### 사실 2: 우리는 이 모든 파라미터를 한 개의 .c 파일에 관리해, 한 개의 c 파일이 3만줄이 넘는다.   
#### 사실 3: 그리고 ... 우리는 신기종을 개발하거나 변경으로 인해 파라미터를 변경해야하면 이 파일을 직접 수정한다...

---
### 결론 1 : 양산 SW 담당자가 실수를 안 할래야 안 할 수가 없다.
### 결론 2 : 양산 SW 담당자가 배포하는 데에 시간이 너무 오래 걸린다. (하나씩 일일이 수정-빌드-대기-파일명수정/수정-빌드-대기-파일명수정)
### 결론 3 : 시험팀이 파라미터 수정하려면 SW 담당자를 거쳐야해 시험이 엄청 불편하다. 

---
....... 놀라지 마시라고 했지만 놀랐을거라 생각한다 .......   

우리 팀은 고질적인 너무 부족한 인력에 허덕이고 있다. 우리 팀 책임님들은 모두 멋진 분들이시다. 이게 비효율적이란 것도 알고 계시다.   
하지만, 도저히 이런 비효율을 개선할 여지가 없이 하루 일주일 한 달 일 년 그리고 수 년이 그냥 지나온 것이다.   

얼마 전, 신혼집의 침대 위치를 바꿔야할 일이 있었다. 집이 (혹은 방이) 충분히 컸다면 침대를 그냥 돌리면 됐을 것이다.   
하지만, 방이 너무 작고 침대가 크다 보니 그냥은 돌릴 수가 없었다. 이부자리와 매트리스를 밖으로 빼고 세로로 세워서 겨우 어떻게 돌려야했다.   

우리 팀도 그렇다. 다들 여유가 있었으면 누군가가 나서서 침대를 돌렸을 것이다. 하지만 지금은 누구도 손을 쓰지 못할 상황인 것 뿐이다.

나는 이 참담한 광경을 처음부터 고치고 싶었다. 다만 멋도 모르는 시절 나서기도 부담스러 가만히 있었을 뿐...   
하지만 이제 캐캐묵은 이 비효율을 내 손으로 고치고자 한다.

문제 해결 방안
===
#### 1. 빌드 비효율 문제
MAKE 파일을 수정하면, Build 전에 직접 #define 을 하고 빌드하는 행위를 연속적으로 해준다고 한다.  
이를 이용하면, 양산 Build 의 비효율을 자동화할 수 있다.

#### 2. PARAMETER 관리 비효율 문제
Partial Flash는 임베디드 SW 에서 일반적이라고 한다. 로직 ROM File 과 파라미터 ROM File 을 분리하면, 파라미터 문제로 전체 ROM VERSION 을 업데이트 할 필요도 없고, 시험팀이 시험하며 쉽게 변경할 수도 있을 것이다.



https://www.nxp.com/docs/en/user-guide/56800EFPUG.pdf

https://www.nxp.com/docs/en/application-note/AN4365.pdf

작성 중. . . 